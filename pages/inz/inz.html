<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" type="text/css" href="jquery.jqplot.min.css" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
</head>
<body>

    <div class='container'>
    <h1>Data processing online tool - under construction</h1>
    <p>This site is part of my Engineering Thesis in field of measurement noise reduction at Faculty of Electrical Engineering of the Warsaw University of Technology. I started with plot drawing for uploaded or sample data. The goal is to find periodicity using autocorrelation and use it to smooth data with average.</p>
    <p>This tool will develop more complicated over time.</p>
    </div>
    <div class='container'>
        <div class='row'>
            <div class='col-md-3'>
                <form>    
                    <div class="form-group">
                        <label for="fileInput" class="btn btn-info">
                            <input type="file" id="fileInput" style="display:none;"  onchange="$('#upload-file-info').html($(this).val());">
                            File input
                        </label>
                        <span id="upload-file-info"></span>
                        </br>
                        <small class="form-text text-muted">Only plain text files. Data separated with space.</small>

                        or 
                        </br>
                        <button type="button" class="btn btn-info" id="sampleFile"> Use sample data </button>
                    </div>
                </form>
                <button type="button" class="btn btn-primary" id="subFile"> RUN </button>
            </div>
            <div class='col-md-9'>
                <h2>Output</h2> 
                <div id='chart1'></div>
            </div>
        </div>
    </div>


<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous">
</script>
<script type="text/javascript" src="jquery.jqplot.min.js"></script>
<script type="text/javascript" src="plugins/jqplot.canvasTextRenderer.js"></script>
<script type="text/javascript" src="plugins/jqplot.canvasAxisLabelRenderer.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<script>
$(function(){
    var textFile ='file not loaded'; 

    var getData =function(event) {
            var files = event.target.files; //FileList object
            for (var i = 0; i < files.length; i++) {
            var file = files[i];
           //Only plain text
                if (!file.type.match('plain')) continue;
                var picReader = new FileReader();
                picReader.addEventListener("load", function(event) {
                textFile = event.target.result;
                });

                //Read the text file
                picReader.readAsText(file);
            }
    }

    var dataPrep=function(data){
        var temp=data;
        temp = temp.replace(/\s+/g,' ');
        var array=data.split(" ");
        return(array);
        }
    
    var dataValid=function(data){
        for (var i=0; i<data.length; i++)
        {
            if (!($.isNumeric(data[i]))) return false;
        }
        return true;
    } 

    var displayOutcome=function(stuff){
        $('#chart1').html('');
        var plot1 = $.jqplot ('chart1', [stuff], {
            title: 'Dane wejÅ›ciowe',
            axesDefaults: {labelRenderer: $.jqplot.CanvasAxisLabelRenderer},
            axes: {
                xaxis: {
                       label: "Sample number",
                       pad: 0
                       },
                yaxis: {
                        label: "Y Axis",
                        max: 100
                        }
            },
            
        });
        
       // $('#display').text(stuff);
    }  

    var fileRun=function(){
        var element=dataPrep(textFile);
        
        if (!dataValid(element)) {$('#display').text('Data not valid! Only numbers, please!')}
        else {displayOutcome(element)};
    }    
    
//---------------------------------------------------------------------------------
    //getting file
    if (window.File && window.FileList && window.FileReader) {
        $("#fileInput").on("change",getData) 
        }
    else {
        alert("Your browser does not support File API");
    }
    $('#sampleFile').click(function(){
        textFile='23 45 6 15 2 7 -3 7 88 2.4 12';
        $('#upload-file-info').html('Sample data used');
    })

    //display file

    $('#subFile').click(fileRun);
    
});

        

</script>

</body>
</html>